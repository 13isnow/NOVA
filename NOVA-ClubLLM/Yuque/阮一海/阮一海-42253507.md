publish time: 2024-11-16T10:46:08.000Z  
https://www.yuque.com/rhg37y/ke52mw/kh3a7adsdlh1waht  
author: 阮一海  
---
[11.15/打碎文档](https://nova.yuque.com/duqs06/unu1at/ewei07cpslbcc308)

本周对社团文档做了一定的预处理：

+ <font style="color:rgb(6, 6, 7);">分块：首先，根据文档内容的逻辑和知识点，将文档分割成多个小的文本块。每个文本块应该围绕一个中心主题或知识点。</font>
+ <font style="color:rgb(6, 6, 7);">去噪：对于每个文本块，去除无关紧要的信息，比如重复的内容、废话等，以提高知识密度。</font>

以求得到更好的总结效果



经过尝试，还是采用直接调用LLM加prompt的办法

总结（总结文本内容）->填充（将原文本填入总结区域）->检查（检查是否有信息遗漏）

确保在信息不丢失的情况下，精简文本量



处理陈柏均的文档得到的KG⬇️

![](https://cdn.nlark.com/yuque/0/2024/png/38709574/1731753344649-ad87f61a-a0fc-40fa-bc54-2d99dccfef4a.png)

相比于之前，已经有一定的提升，可以看出节点连接的更合理了一些，簇划分也更紧密一些

但是仍然存在问题

+ 节点选取

这些节点选取得还是有些问题，比如LLM提取出来当初关于寝室问卷的问题要点，但这并不是我们关心	的，我们想要实现问卷的技术知识，而非“寝室卫生”“室友性格”等具体细节

+ 文档关系

可以看到，LLM根本没有将文档节点（紫色）与关键词节点（蓝色）连接，为什么？

+ 奇怪的节点

绿色节点与红色节点并不是我们需要的



我怀疑是prompt的问题

以往都是使用graphrag自动生成的prompt，但实际上

<details class="lake-collapse"><summary id="u7007ead9"><span class="ne-text">prompt</span></summary><p id="u722342b5" class="ne-p"><span class="ne-text">You are an expert sociologist of technology. You are skilled at analyzing social networks and community structures, particularly within digital domains. You are adept at helping people understand and identify the relations and structure of communities of interest, such as those found in the AI and LLM domain.</span></p><p id="u7769888c" class="ne-p"><span class="ne-text"></span></p><p id="u4af991aa" class="ne-p"><span class="ne-text"># Goal</span></p><p id="u5990e443" class="ne-p"><span class="ne-text">Write a comprehensive assessment report of a community taking on the role of a 基于您提供的示例和要求，以下是针对AI和LLM领域的社区分析角色定义，结构与您提供的示例一致：</span></p><p id="u2e8f7423" class="ne-p"><span class="ne-text"></span></p><p id="u02dfe03b" class="ne-p"><span class="ne-text">---</span></p><p id="u8d6a25b9" class="ne-p"><span class="ne-text"></span></p><p id="ud0177859" class="ne-p"><span class="ne-text">### 角色定义</span></p><p id="ufffcaaba" class="ne-p"><span class="ne-text"></span></p><p id="u3b67f372" class="ne-p"><span class="ne-text">**AI和LLM领域社区分析师**</span></p><p id="u64c143c4" class="ne-p"><span class="ne-text"></span></p><p id="u02871bc5" class="ne-p"><span class="ne-text">任务描述：作为AI和LLM领域的社区分析师，你将从给定的数字社区中提取关键实体及其关系，帮助决策者了解社区的发展动态和潜在的影响。你的工作涉及对AI和LLM社区的深入理解和分析，包括但不限于社区成员的角色、互动模式、以及他们在推动技术进步中的贡献。</span></p><p id="ub83eb47f" class="ne-p"><span class="ne-text"></span></p><p id="ue5a73c4e" class="ne-p"><span class="ne-text">**输入要求：**</span></p><p id="u9f334906" class="ne-p"><span class="ne-text">- 社区成员名单及简介</span></p><p id="u729419b8" class="ne-p"><span class="ne-text">- 成员间的互动记录（例如论坛帖子、讨论、项目协作等）</span></p><p id="uf67bde1b" class="ne-p"><span class="ne-text">- 社区中的重要事件和里程碑（如重大合作、项目发布等）</span></p><p id="u7d60c7bd" class="ne-p"><span class="ne-text">- 可选：额外的背景信息或关联声明</span></p><p id="u598296eb" class="ne-p"><span class="ne-text"></span></p><p id="ubd816b3c" class="ne-p"><span class="ne-text">**输出目标：**</span></p><p id="ud0f02958" class="ne-p"><span class="ne-text">- 社区结构概述，包括核心成员、新兴领袖、活跃讨论主题等。</span></p><p id="u16b46c50" class="ne-p"><span class="ne-text">- 成员之间关系图谱，展示网络中的连接方式（如合作者、导师、学生等）。</span></p><p id="u2fcf7d65" class="ne-p"><span class="ne-text">- 社区影响力分析，探讨社区如何影响技术进步和社会变革。</span></p><p id="u409be6dd" class="ne-p"><span class="ne-text">- 关键见解和建议，供决策者参考，以促进社区的健康发展和持续成长。</span></p><p id="u6b5acfa1" class="ne-p"><span class="ne-text"></span></p><p id="u21fdb29c" class="ne-p"><span class="ne-text">---</span></p><p id="u9722cdc4" class="ne-p"><span class="ne-text"></span></p><p id="ub04495e2" class="ne-p"><span class="ne-text">这个角色定义旨在帮助理解AI和LLM领域的社区结构和动态，通过分析社区内的相互作用关系，从而识别出社区的核心力量和潜在的发展趋势。. The content of this report includes an overview of the community's key entities and relationships.</span></p><p id="u26eb4544" class="ne-p"><span class="ne-text"></span></p><p id="u1c8520b1" class="ne-p"><span class="ne-text"># Report Structure</span></p><p id="u087316ff" class="ne-p"><span class="ne-text">The report should include the following sections:</span></p><p id="uc9ecd04c" class="ne-p"><span class="ne-text">- TITLE: community's name that represents its key entities - title should be short but specific. When possible, include representative named entities in the title.</span></p><p id="ufa9232c3" class="ne-p"><span class="ne-text">- SUMMARY: An executive summary of the community's overall structure, how its entities are related to each other, and significant points associated with its entities.</span></p><p id="u786277d2" class="ne-p"><span class="ne-text">- REPORT RATING: A float score between 0-10 that represents the relevance of the text to AI and LLM, community structures, and digital domain analysis, with 1 being trivial or irrelevant and 10 being highly significant, impactful, and insightful for understanding the relations and dynamics within the AI and LLM domain. This text discusses models, algorithms, and techniques used for optimizing user grouping and allocation, which are highly pertinent to the analysis of community structures and digital interactions within the AI and LLM domain. Therefore, the score should reflect significant relevance and applicability within the specified domain and persona.</span></p><p id="u0db5210e" class="ne-p"><span class="ne-text">- RATING EXPLANATION: Give a single sentence explanation of the rating.</span></p><p id="u87717c7e" class="ne-p"><span class="ne-text">- DETAILED FINDINGS: A list of 5-10 key insights about the community. Each insight should have a short summary followed by multiple paragraphs of explanatory text grounded according to the grounding rules below. Be comprehensive.</span></p><p id="u0eaf09d7" class="ne-p"><span class="ne-text"></span></p><p id="u2ca0f072" class="ne-p"><span class="ne-text">Return output as a well-formed JSON-formatted string with the following format. Don't use any unnecessary escape sequences. The output should be a single JSON object that can be parsed by json.loads.</span></p><p id="u8e133214" class="ne-p"><span class="ne-text">    {</span></p><p id="u220589c6" class="ne-p"><span class="ne-text">        &quot;title&quot;: &quot;&lt;report_title&gt;&quot;,</span></p><p id="u0affd507" class="ne-p"><span class="ne-text">        &quot;summary&quot;: &quot;&lt;executive_summary&gt;&quot;,</span></p><p id="u4ffebbb7" class="ne-p"><span class="ne-text">        &quot;rating&quot;: &lt;threat_severity_rating&gt;,</span></p><p id="u2a77868c" class="ne-p"><span class="ne-text">        &quot;rating_explanation&quot;: &quot;&lt;rating_explanation&gt;&quot;</span></p><p id="ubbd50e9b" class="ne-p"><span class="ne-text">        &quot;findings&quot;: &quot;[{&quot;summary&quot;:&quot;&lt;insight_1_summary&gt;&quot;, &quot;explanation&quot;: &quot;&lt;insight_1_explanation&quot;}, {&quot;summary&quot;:&quot;&lt;insight_2_summary&gt;&quot;, &quot;explanation&quot;: &quot;&lt;insight_2_explanation&quot;}]&quot;</span></p><p id="u9f138b47" class="ne-p"><span class="ne-text">    }</span></p><p id="u863606a3" class="ne-p"><span class="ne-text"></span></p><p id="uadeae3b9" class="ne-p"><span class="ne-text"># Grounding Rules</span></p><p id="u0d172bc0" class="ne-p"><span class="ne-text">After each paragraph, add data record reference if the content of the paragraph was derived from one or more data records. Reference is in the format of [records: &lt;record_source&gt; (&lt;record_id_list&gt;, ...&lt;record_source&gt; (&lt;record_id_list&gt;)]. If there are more than 10 data records, show the top 10 most relevant records.</span></p><p id="u9633b0cf" class="ne-p"><span class="ne-text">Each paragraph should contain multiple sentences of explanation and concrete examples with specific named entities. All paragraphs must have these references at the start and end. Use &quot;NONE&quot; if there are no related roles or records. Everything should be in Chinese.</span></p><p id="u50ee19d3" class="ne-p"><span class="ne-text"></span></p><p id="ue3567fe0" class="ne-p"><span class="ne-text">Example paragraph with references added:</span></p><p id="uc5db31bb" class="ne-p"><span class="ne-text">This is a paragraph of the output text [records: Entities (1, 2, 3), Claims (2, 5), Relationships (10, 12)]</span></p><p id="u2c40cf5d" class="ne-p"><span class="ne-text"></span></p><p id="uabbd7c27" class="ne-p"><span class="ne-text"># Example Input</span></p><p id="u9653adb0" class="ne-p"><span class="ne-text">-----------</span></p><p id="u21fbbe45" class="ne-p"><span class="ne-text">Text:</span></p><p id="u379fffce" class="ne-p"><span class="ne-text"></span></p><p id="u63c204f7" class="ne-p"><span class="ne-text">Entities</span></p><p id="ucad22764" class="ne-p"><span class="ne-text"></span></p><p id="ubeea8b1a" class="ne-p"><span class="ne-text">id,entity,description</span></p><p id="u7f4a917c" class="ne-p"><span class="ne-text">5,ABILA CITY PARK,Abila City Park is the location of the POK rally</span></p><p id="ue4352b0e" class="ne-p"><span class="ne-text"></span></p><p id="udcf98883" class="ne-p"><span class="ne-text">Relationships</span></p><p id="uc1b95ea3" class="ne-p"><span class="ne-text"></span></p><p id="uf14f17ff" class="ne-p"><span class="ne-text">id,source,target,description</span></p><p id="u55735ea4" class="ne-p"><span class="ne-text">37,ABILA CITY PARK,POK RALLY,Abila City Park is the location of the POK rally</span></p><p id="u6d200ac8" class="ne-p"><span class="ne-text">38,ABILA CITY PARK,POK,POK is holding a rally in Abila City Park</span></p><p id="u7f61fcef" class="ne-p"><span class="ne-text">39,ABILA CITY PARK,POKRALLY,The POKRally is taking place at Abila City Park</span></p><p id="u226def88" class="ne-p"><span class="ne-text">40,ABILA CITY PARK,CENTRAL BULLETIN,Central Bulletin is reporting on the POK rally taking place in Abila City Park</span></p><p id="u2ae46279" class="ne-p"><span class="ne-text"></span></p><p id="u8460c50a" class="ne-p"><span class="ne-text">Output:</span></p><p id="ue6462579" class="ne-p"><span class="ne-text">{</span></p><p id="u51b06b87" class="ne-p"><span class="ne-text">    &quot;title&quot;: &quot;Abila City Park and POK Rally&quot;,</span></p><p id="u8aa55378" class="ne-p"><span class="ne-text">    &quot;summary&quot;: &quot;The community revolves around the Abila City Park, which is the location of the POK rally. The park has relationships with POK, POKRALLY, and Central Bulletin, all</span></p><p id="u5d50787c" class="ne-p"><span class="ne-text">of which are associated with the rally event.&quot;,</span></p><p id="ucfafacb9" class="ne-p"><span class="ne-text">    &quot;rating&quot;: 5.0,</span></p><p id="u7dd68311" class="ne-p"><span class="ne-text">    &quot;rating_explanation&quot;: &quot;The impact rating is moderate due to the potential for unrest or conflict during the POK rally.&quot;,</span></p><p id="ue4c58de5" class="ne-p"><span class="ne-text">    &quot;findings&quot;: [</span></p><p id="u7fceef07" class="ne-p"><span class="ne-text">        {</span></p><p id="u6a3572da" class="ne-p"><span class="ne-text">            &quot;summary&quot;: &quot;Abila City Park as the central location&quot;,</span></p><p id="ua07057fa" class="ne-p"><span class="ne-text">            &quot;explanation&quot;: &quot;Abila City Park is the central entity in this community, serving as the location for the POK rally. This park is the common link between all other</span></p><p id="u411758d2" class="ne-p"><span class="ne-text">entities, suggesting its significance in the community. The park's association with the rally could potentially lead to issues such as public disorder or conflict, depending on the</span></p><p id="u61f7af6f" class="ne-p"><span class="ne-text">nature of the rally and the reactions it provokes. [records: Entities (5), Relationships (37, 38, 39, 40)]&quot;</span></p><p id="ub2f53a2f" class="ne-p"><span class="ne-text">        },</span></p><p id="ud0fb11e8" class="ne-p"><span class="ne-text">        {</span></p><p id="uc8614dc5" class="ne-p"><span class="ne-text">            &quot;summary&quot;: &quot;POK's role in the community&quot;,</span></p><p id="u6b99271f" class="ne-p"><span class="ne-text">            &quot;explanation&quot;: &quot;POK is another key entity in this community, being the organizer of the rally at Abila City Park. The nature of POK and its rally could be a potential</span></p><p id="u7a81c5d8" class="ne-p"><span class="ne-text">source of threat, depending on their objectives and the reactions they provoke. The relationship between POK and the park is crucial in understanding the dynamics of this community.</span></p><p id="u3b237153" class="ne-p"><span class="ne-text">[records: Relationships (38)]&quot;</span></p><p id="u5d50d089" class="ne-p"><span class="ne-text">        },</span></p><p id="ue991d2ce" class="ne-p"><span class="ne-text">        {</span></p><p id="uefdd384d" class="ne-p"><span class="ne-text">            &quot;summary&quot;: &quot;POKRALLY as a significant event&quot;,</span></p><p id="ube1db8b8" class="ne-p"><span class="ne-text">            &quot;explanation&quot;: &quot;The POKRALLY is a significant event taking place at Abila City Park. This event is a key factor in the community's dynamics and could be a potential</span></p><p id="uf314810d" class="ne-p"><span class="ne-text">source of threat, depending on the nature of the rally and the reactions it provokes. The relationship between the rally and the park is crucial in understanding the dynamics of this</span></p><p id="u0590ec2e" class="ne-p"><span class="ne-text">community. [records: Relationships (39)]&quot;</span></p><p id="uae7a1fe2" class="ne-p"><span class="ne-text">        },</span></p><p id="u9799ed4b" class="ne-p"><span class="ne-text">        {</span></p><p id="u7b8d9869" class="ne-p"><span class="ne-text">            &quot;summary&quot;: &quot;Role of Central Bulletin&quot;,</span></p><p id="u135b723c" class="ne-p"><span class="ne-text">            &quot;explanation&quot;: &quot;Central Bulletin is reporting on the POK rally taking place in Abila City Park. This suggests that the event has attracted media attention, which could</span></p><p id="u10faaf01" class="ne-p"><span class="ne-text">amplify its impact on the community. The role of Central Bulletin could be significant in shaping public perception of the event and the entities involved. [records: Relationships</span></p><p id="u7cf914a7" class="ne-p"><span class="ne-text">(40)]&quot;</span></p><p id="u4fa371a0" class="ne-p"><span class="ne-text">        }</span></p><p id="u35fc7bc9" class="ne-p"><span class="ne-text">    ]</span></p><p id="u7d6a42b3" class="ne-p"><span class="ne-text"></span></p><p id="u6c42c899" class="ne-p"><span class="ne-text">}</span></p><p id="ue5ea8143" class="ne-p"><span class="ne-text"></span></p><p id="u11f1f9ec" class="ne-p"><span class="ne-text"># Real Data</span></p><p id="u20b91c11" class="ne-p"><span class="ne-text"></span></p><p id="u4c2df843" class="ne-p"><span class="ne-text">Use the following text for your answer. Do not make anything up in your answer.</span></p><p id="u2dbf2642" class="ne-p"><span class="ne-text"></span></p><p id="uf08e85df" class="ne-p"><span class="ne-text">Text:</span></p><p id="u12e7fdf9" class="ne-p"><span class="ne-text">{input_text}</span></p><p id="u0e8c041d" class="ne-p"><span class="ne-text">Output:</span></p></details>
疑似有点过于笼统了

---

下一阶段目标

+ 手动修改graphrag的prompt

---

题外话：

我用的是通义的API，直接在本地调用了graphrag封装的接口

为什么我37.8B的文本数据，不到10min就跑完了……

以及lightrag我也注意到了，但抽了眼文档跟我想要实现的功能（KG构建）疑似不符。至于真实情况嘛，交给张铭恺了😋

